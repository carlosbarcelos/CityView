<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>3D Visualization</title> 
    <link rel="stylesheet" type="text/css" href="css/main_about.css">
     <link rel="stylesheet" type="text/css" href="css/people.css">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<link rel="stylesheet" media="screen" href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" />
	<link rel="stylesheet" media="all" href="https://d2sxfzw9cql5wy.cloudfront.net/assets/v2-prospect-f62c3e8107723d8291b7d8bef73ccc6122ea918e640399c78de2ddc3340abdf5.css" />
	<link rel="stylesheet" media="print" href="https://d39afr5wio5j08.cloudfront.net/assets/print-5a29a9c455566fcb04f2d8332508e186e7022c91b0d2775f86018f0404780d01.css" />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.css' rel='stylesheet' />    
  </head>
  <body>
    <header class= tm-header>
      <div class="tm-container">
        <a href="index.html">
        <img src="Images/SURV_logo2.png" alt="logo" width="120" class="surv-logo">
		<a href="https://www.wpi.edu">
		<img src="Images/WPI_logo.png" alt="WPI logo" width="120" class="wpi-logo">
			
			
		<a href="https://www.nsf.gov">
		<img src="Images/nsf_logo.jpg" alt="NSF logo" width="120" class="nsf-logo">
        <nav class ="tm-nav">
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="AboutPage.html">About</a></li>
            <li class="dropdown">
				<a href="javascript:void(0)" class="dropbtn">Research + Projects</a>
    			<div class="dropdown-content">
      				<!-- <a href="#">Link 1</a> -->
      				<a href="DataAnimationPage.html">Data Animation</a>
     				<a href="3DheatmapPage.html">3D Visualization</a>
     				<a href="3DhmTimePage.html">3D Visual Interaction</a>
     				<a href="Google_heatmapPage.html">Data Upload Example</a>
     			</div>
			</li>
            <li><a href="TeamPage.html">Contact Our Team</a></li>
          </ul>
        </nav>
      </div>
    </header>
     <!--   Adding a footer
	<footer class= bm-footer>
		<div class="bm-container">
			<a href="https://www.wpi.edu">
			<img src="WPI_logo.png" alt="WPI logo" width="120" class="wpi-logo">
		</div>
	</footer>
	-->  
    <div id='map'></div>        
    <nav id='listing-group' class='listing-group'>
    <input type='checkbox' id='scrollZoom' checked='checked'>
    <label for='scrollZoom'>Scroll zoom</label>
    <input type='checkbox' id='boxZoom' checked='checked'>
    <label for='boxZoom'>Box zoom</label>
    <input type='checkbox' id='dragRotate' checked='checked'>
    <label for='dragRotate'>Drag rotate</label>
    <input type='checkbox' id='dragPan' checked='checked'>
    <label for='dragPan'>Drag pan</label>
    <input type='checkbox' id='keyboard' checked='checked'>
    <label for='keyboard'>Keyboard</label>
    <input type='checkbox' id='doubleClickZoom' checked='checked'>
    <label for='doubleClickZoom'>Double click zoom</label>
    <input type='checkbox' id='touchZoomRotate' checked='checked'>
    <label for='touchZoomRotate'>Touch zoom rotate</label>
    </nav>   
    <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiY2h1YWNvbiIsImEiOiJjajRlOXljb2cwMTd3MnhsYXQ4NnY0dXR0In0.GZ2wwLLO4yd_1PoQrNG-UA';               
    var map, layerList, inputs   
    map = new mapboxgl.Map({
    	container: 'map',
    	//style: 'mapbox://styles/mapbox/dark-v9',    
    	style: 'mapbox://styles/chuacon/cj4ud2suu03m82smmv58rs917',	
    	center: [114.0579, 22.5431],
    	zoom: 8,
    	pitch: 0,
    	bearing: 0,
    	});
    	document.getElementById('listing-group').addEventListener('change', function(e) {
    		var handler = e.target.id;
    		if (e.target.checked) {
    			map[handler].enable();
    			} else {
    				map[handler].disable();
    			}
    	});	
       map.on('load', function() {       	      	
    	map.addLayer({
    		'id': '3d-buildings',
    		'source': 'composite',
    		'source-layer': 'building',
    		'filter': ['==', 'extrude', 'true'],
    		'type': 'fill-extrusion',
    		'minzoom': 15,
    		'paint': {
    			'fill-extrusion-color': '#aaa',
    			'fill-extrusion-height': {
    				'type': 'identity',
    				'property': 'height'
    				},
    				'fill-extrusion-base': {
    					'type': 'identity',
    					'property': 'min_height'
    					},
    					'fill-extrusion-opacity': .6
    					}
    		});
    // Add a new source from our GeoJSON data and set the
    // 'cluster' option to true.
    map.addSource("long_and_lat", {
        type: "geojson",
        // Point to GeoJSON data. This example visualizes Taxi GPS Data in Shenzhen, China
        // for three days from 10/22/2103 - 10/24/2013 as logged by Desheng Zhang |Assistant Professor|Department of Computer Science|Rutgers University|
        // https://www.cs.rutgers.edu/~dz220/data.html
        // The data from https://www.cs.rutgers.edu/~dz220/data.html was used and converted from csv to geojson using a python script
        data: "testing_data000.geojson", // Make sure to use "https" if loading the page with https.
        cluster: true,
        //clusterMaxZoom: 15, // Max zoom to cluster points on
        clusterRadius: 8 // Use small cluster radius for the heatmap look
    });
    // Use the long_and_lat source to create four layers:
    // three for each cluster category, and one for unclustered points
    // Each point range gets a different fill color.
    var layers = [
        [0, '#404387'],
        [10, '#29788E'],
        [30, '#22A784'],
        [40, '#79D151'],
        [50, '#FDE724'],
        //[100, '#FBFCBF']
    ];
    layers.forEach(function (layer, i) {
        map.addLayer({
            "id": "cluster-" + i,
            "type": "circle",
            "source": "long_and_lat",
            "paint": {
                "circle-color": layer[1],
                "circle-radius": 50,
                "circle-blur": 1 // blur the circles to get a heatmap look
            },
            "filter": i === layers.length - 1 ?
                [">=", "point_count", layer[0]] :
                ["all",
                    [">=", "point_count", layer[0]],
                    ["<", "point_count", layers[i + 1][0]]]    
        }, 'waterway-label');        
        });
    map.addLayer({
        "id": "unclustered-points",
        "type": "circle",
        "source": "long_and_lat",
        "paint": {
            "circle-color": '#404387',
            "circle-radius": 20,
            "circle-blur": 1
        },
        "filter": ["!=", "cluster", true]
    }, 'waterway-label');
});
</script>
  </body>
</html>