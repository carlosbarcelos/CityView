<html>
<head>
  <meta charset='utf-8' />
  <title>|Shenzhen|China|GPS Data|Visual|</title>
  <link rel="stylesheet" type="text/css" href="css/mapping__.css">
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <link rel="stylesheet" media="screen" href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" />
  <link rel="stylesheet" media="all" href="https://d2sxfzw9cql5wy.cloudfront.net/assets/v2-prospect-f62c3e8107723d8291b7d8bef73ccc6122ea918e640399c78de2ddc3340abdf5.css" />
  <link rel="stylesheet" media="print" href="https://d39afr5wio5j08.cloudfront.net/assets/print-5a29a9c455566fcb04f2d8332508e186e7022c91b0d2775f86018f0404780d01.css" />
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.css' rel='stylesheet' />
  </head>
<body>
	<header class= tm-header>
      <div class="tm-container">
        <a href="index.html">
        <img src="Images/SURV_logo2.png" alt="logo" width="120" class="surv-logo">
		<a href="https://www.wpi.edu">
		<img src="Images/WPI_logo.png" alt="WPI logo" width="120" class="wpi-logo">	
		<a href="https://www.nsf.gov">
		<img src="Images/nsf_logo.jpg" alt="NSF logo" width="120" class="nsf-logo">
        <nav class ="tm-nav">
          <ul>
            <li><a href="http://users.wpi.edu/~chuacon/Data%20Visualization/htdocs/Testing.html">Home</a></li>
            <li><a href="AboutPage.html">About</a></li>
            <li class="dropdown">
				<a href="javascript:void(0)" class="dropbtn">Research + Projects</a>
    			<div class="dropdown-content">
      				<!-- <a href="#">Link 1</a> -->
      				<a href="DataAnimationPage.html">Data Animation</a>
     				<a href="3DheatmapPage.html">3D Visualization</a>
     				<a href="3DhmTimePage.html">3D Visual Interaction</a>
     				<a href="Google_heatmapPage.html">Data Upload Example</a>
     			</div>
			</li>
            <li><a href="TeamPage.html">Contact Our Team</a></li>
          </ul>
        </nav>
      </div>
    </header>
     <!--   Adding a footer
	<footer class= bm-footer>
		<div class="bm-container">
			<a href="https://www.wpi.edu">
			<img src="WPI_logo.png" alt="WPI logo" width="120" class="wpi-logo">
		</div>
	</footer>
	-->
  <div id='map'></div>
  <div id='console'>
    <h1>Taxi GPS Data</h1>
    <p>Data: <a href='testing_data000.geojson'>Taxi GPS Speed Data</a> in Shenzhen,China, Oct 2013</p>
    <div class='session'>
      <h2>Speed</h2>
      <div class='row colors'></div>
      <div class='row labels'>
        <div class='label'>0</div>
        <div class='label'>10</div>
        <div class='label'>20</div>
        <div class='label'>30</div>
        <div class='label'>40</div>
        <div class='label'>50+</div>
      </div>
    </div>
    <div class='session' id='sliderbar'>
      <h2>Hour: <label id='active-hour'>12PM</label></h2>
      <input id='slider' class='row' type='range' min='0' max='23' step='1' value='12' />
    </div>
    <div class='session'>
    	<h2>Day of the week</h2>
    	<div class='row' id='filters'>
    		<input id='all' type='radio' name='toggle' value='all' checked='checked'>
    		<label for='all'>All</label>
    		<input id='weekday' type='radio' name='toggle' value='weekday'>
    		<label for='weekday'>Weekday</label>
    		<input id='weekend' type='radio' name='toggle' value='weekend'>
    		<label for='weekend'>Weekend</label>
    	</div>
    </div>
  </div>
  <script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2lqbmpqazdlMDBsdnRva284cWd3bm11byJ9.V6Hg2oYJwMAxeoR9GEzkAA';
  // This adds the map to your page
  var map = new mapboxgl.Map({
    container: 'map', // container id specified in the HTML
    style: 'mapbox://styles/mapbox/traffic-night-v2', // style URL
    center: [114.0579, 22.5431], // initial map center in [lon, lat]
    zoom: 12
  });
  map.on('load', function() {
    var filterHour = ['==', 'Hour', 12];
    var filterDay = ['!=', 'Day', 'Bob'];
    map.addLayer({
    	'id': '3d-buildings',
    	'source': 'composite',
    	'source-layer': 'building',
    	'filter': ['==', 'extrude', 'true'],
    	'type': 'fill-extrusion',
    	'minzoom': 15,
    	'paint': {
    		'fill-extrusion-color': '#aaa',
    		'fill-extrusion-height': {
    			'type': 'identity',
    			'property': 'height'
    			},
    			'fill-extrusion-base': {
    				'type': 'identity',
    				'property': 'min_height'
    			},
    		'fill-extrusion-opacity': .6
    	}
    });
    map.addLayer({
      id: 'collisions',
      type: 'circle',
      source: {
        type: 'geojson',
        data: 'testing_data000.geojson' // replace this with the url of your own geojson
      },
      paint: {
        'circle-radius': {
          property: 'Speed',
          stops: [
            [0, 3],
            [5, 15]
          ]
        },
        'circle-color': {
          property: 'Speed',
          stops: [
            [0, '#0080FF'],
        	[1, '#73B98B'],
        	[2, '#FFF300'],
        	[3, '#FF9700'],
        	[4, '#FF5000'],
        	[5, '#FF1000']
          ]
        },
        'circle-opacity': 0.8,
        'circle-blur': 1
      },
      filter: ['all', filterHour, filterDay]
    }, 'admin-2-boundaries-dispute'); // place the layer beneath this layer in the basemap
    document.getElementById('slider').addEventListener('input', function(e) {
      // get the current hour as a integer
      var hour = parseInt(e.target.value);
      // map.setFilter(layer-name, filter)
      filterHour = ['==', 'Hour', hour];
      map.setFilter('collisions', ['all', filterHour, filterDay]);
      // converting 0-23 hour to AMPM format
      var ampm = hour >= 12 ? 'PM' : 'AM';
      var hour12 = hour % 12 ? hour % 12 : 12;
      // update text in the UI
      document.getElementById('active-hour').innerText = hour12 + ampm;
    });
    document.getElementById('filters').addEventListener('change', function(e) {
      var day = e.target.value;
      if (day === 'all') {
        // feature[key] exists
        filterDay = ['!=', 'Day', 'Bob'];
      } else if (day === 'weekday') {
        // feature[key] is any of these values
        filterDay = ['!in', 'Day', 'Sat', 'Sun'];
      } else if (day === 'weekend') {
        // feature[key] is not any of these values
        filterDay = ['in', 'Day', 'Sat', 'Sun'];
      } else {
        console.log('error');
      }
      map.setFilter('collisions', ['all', filterHour, filterDay]);
    });
  });
  </script>
</body>